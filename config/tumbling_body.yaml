# Icarus Simulation Configuration
# Tumbling Rigid Body Demo
#
# A torque-free tumbling rigid body demonstrating:
# - RigidBody6DOF with quaternion attitude
# - Angular momentum conservation
# - Energy conservation

simulation:
  name: "Tumbling Rigid Body"
  version: "1.0.0"
  description: |
    A torque-free asymmetric rigid body tumbling in space.
    Validates conservation of angular momentum and energy.

# =============================================================================
# Logging Configuration
# =============================================================================

logging:
  console_level: info       # trace, debug, info, warning, error
  file_enabled: false      # Set to true to write log file
  file_path: "tumbling_body_demo.log"
  file_level: info
  progress_enabled: false
  profiling_enabled: false

# =============================================================================
# Time Configuration
# =============================================================================

time:
  start: 0.0
  end: 10.0          # 10 seconds of tumbling
  dt: 0.005          # 200 Hz for high accuracy

# =============================================================================
# Integrator Configuration
# =============================================================================

integrator:
  type: RK4

# =============================================================================
# Components
# =============================================================================

components:
  # Static mass properties (asymmetric brick: Ix < Iy < Iz)
  - type: StaticMass
    name: Mass
    scalars:
      mass: 10.0           # kg
      inertia_xx: 1.0      # kg*m^2
      inertia_yy: 2.0      # kg*m^2
      inertia_zz: 3.0      # kg*m^2
      inertia_xy: 0.0
      inertia_xz: 0.0
      inertia_yz: 0.0

  # Force aggregator (provides zero force/moment for torque-free motion)
  - type: ForceAggregator
    name: Forces
    # No sources - outputs zero force/moment

  # 6DOF rigid body dynamics
  - type: RigidBody6DOF
    name: Body
    vectors:
      initial_position: [0.0, 0.0, 0.0]
      initial_velocity_body: [0.0, 0.0, 0.0]
      initial_attitude: [1.0, 0.0, 0.0, 0.0]  # Identity quaternion [w,x,y,z]
      initial_omega_body: [1.0, 0.5, 0.2]     # rad/s - off principal axes

# =============================================================================
# Signal Routing
# =============================================================================

routes:
  # RigidBody reads mass properties from StaticMass
  - input: Body.total_mass
    output: Mass.mass
  - input: Body.inertia.xx
    output: Mass.inertia.xx
  - input: Body.inertia.yy
    output: Mass.inertia.yy
  - input: Body.inertia.zz
    output: Mass.inertia.zz
  - input: Body.inertia.xy
    output: Mass.inertia.xy
  - input: Body.inertia.xz
    output: Mass.inertia.xz
  - input: Body.inertia.yz
    output: Mass.inertia.yz

  # RigidBody reads force/moment from ForceAggregator
  - input: Body.total_force.x
    output: Forces.total_force.x
  - input: Body.total_force.y
    output: Forces.total_force.y
  - input: Body.total_force.z
    output: Forces.total_force.z
  - input: Body.total_moment.x
    output: Forces.total_moment.x
  - input: Body.total_moment.y
    output: Forces.total_moment.y
  - input: Body.total_moment.z
    output: Forces.total_moment.z

  # ForceAggregator needs CG input (wire to Mass.cg)
  - input: Forces.cg.x
    output: Mass.cg.x
  - input: Forces.cg.y
    output: Mass.cg.y
  - input: Forces.cg.z
    output: Mass.cg.z

# =============================================================================
# Scheduler Configuration
# =============================================================================

scheduler:
  groups:
    - name: mass
      rate_hz: 200.0
      priority: 1
      members:
        - component: Mass
          priority: 1

    - name: forces
      rate_hz: 200.0
      priority: 2
      members:
        - component: Forces
          priority: 1

    - name: dynamics
      rate_hz: 200.0
      priority: 3
      members:
        - component: Body
          priority: 1
